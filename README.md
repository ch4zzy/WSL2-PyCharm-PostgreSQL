# WSL2-PyCharm-PostgreSQL
**How to connect to PostgreSQL database which is installed in WSL2 from Pycharm or other JetBrains products?**

After creating a postgresql database in WSL2 and trying to connect to it from PyCharm or another JetBrains product, you may encounter problem `[28P01]`.

![Error message:](https://github.com/ch4zzy/WSL2-PyCharm-PostgreSQL/blob/main/error_message.png)

This is because you are trying to connect to the database via localhost, which by default points to your device where WSL2 is installed.

## Step 1

In order to fix this you must do some actions:

Write in bash `ifconfig`, you should see your inet address. In my case, it's `172.23.76.185`, we need this address to connect the database to PyCharm.
```
ch4zzy:~$ ifconfig
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1280
        inet 172.23.76.185  netmask 255.255.240.0  broadcast 172.23.79.255
        inet6 fe80::215:5dff:fede:30f9  prefixlen 64  scopeid 0x20<link>
        ether 00:15:5d:de:30:f9  txqueuelen 1000  (Ethernet)
        RX packets 104  bytes 39421 (39.4 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 46  bytes 9273 (9.2 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 243  bytes 82134 (82.1 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 243  bytes 82134 (82.1 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
```

## Step 2

Next we need the address of our virtual machine, write `cat /etc/resolv.conf`. In my case, it's `172.23.64.1`.

```
ch4zzy:~$ cat /etc/resolv.conf
# This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf:
# [network]
# generateResolvConf = false
nameserver 172.23.64.1
```

## Step 3

This address must be entered in the `pg_pga.conf` file. Write `sudo nano /etc/postgresql/14/main/pg_hba.conf`, instead of 14 you should write your postgres version. 

Add thd line, instead of `172.23.64.1/0` use your VM ip from [previous step](https://github.com/ch4zzy/WSL2-PyCharm-PostgreSQL/edit/main/README.md#wsl2-pycharm-postgresql:~:text=0%20%20collisions%200-,Step%202,-Next%20we%20need).

`host    all             all             172.23.64.1/0           md5`

## Step 4

In the configuration file `sudo nano /etc/postgresql/14/main/postgresql.conf`, change the line:

`listen_addresses = 'localhost'`
to 
`listen_addresses = '*'`

## Step 5

Restart your postgresql service and try to connect using IP from the [first step](https://github.com/ch4zzy/WSL2-PyCharm-PostgreSQL/edit/main/README.md#wsl2-pycharm-postgresql:~:text=WSL2%20is%20installed.-,Step%201,-In%20order%20to) as host.

![Success message:](https://github.com/ch4zzy/WSL2-PyCharm-PostgreSQL/blob/main/success_message.png)

